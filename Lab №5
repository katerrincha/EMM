
##------------------------- ‚Ññ5. –ë—Ä–æ—É–Ω–æ–≤—Å–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ ----------------------------

# 1. –ü—Ä–æ–≤–µ—Å—Ç–∏ –≤—ã–∫–ª–∞–¥–∫–∏ –∏ –æ–±–æ—Å–Ω–æ–≤–∞—Ç—å, —á—Ç–æ –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ (8) –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —É—Å–ª–æ–≤–∏—è, 
#–Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ–º—ã–µ –Ω–∞ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –¥–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ
#Eùêµùëò‚àÜ = 0, Eùêµ2ùëò‚àÜ = ùëò‚àÜ, Eùêµùëò‚àÜùêµùëô‚àÜ = ‚àÜ min(ùëô,ùëò), –ø—Ä–∏ ùêµ0 = 0.

# —Å–º. –ª–∏—Å—Ç–∏–∫ –≤ —Ñ–∞–π–ª–µ!

# 2. –ó–∞–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å (8) –¥–ª—è ‚àÜ = 0.0001 ( —Ç.–µ. —Å—Ä–µ–¥–Ω–µ-–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–æ–µ
#–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Å.–≤. ùúÄùëò‚àÜ —Ä–∞–≤–Ω–æ ‚àö‚àÜ = 0.01) –∏ ùëò = 0, 1, . . . , 10^3.

delta = 0.0001
k = 0 : 1000
n = 1000
e = rnorm(n + 1, 0, sqrt(delta)) 
B = 0
for(k in 1 : n)
  B[k + 1] = B[k] + e[k] 
plot(seq(0, delta*1000, delta), B, type = 'l', main = "–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ (8):") # —Å —à–∞–≥–æ–º 0,0001

# 3. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∞–Ω—Å–∞–º–±–ª—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞, –∑–∞–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º
#—à–∞–≥–µ, –∏ –≤—ã–≤–µ—Å—Ç–∏ –≤—Å–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–∞ –æ–¥–∏–Ω –≥—Ä–∞—Ñ–∏–∫. –¢.–µ. –ø–æ—Å—Ç—Ä–æ–∏—Ç—å 200 
#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞ (8) –Ω–∞ –æ–¥–Ω–æ–º –≥—Ä–∞—Ñ–∏–∫–µ.

plot(seq(0, delta*1000, delta), B, type = 'l', ylim = c(-1, 1), col = "purple", main = "200 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞ (8):")
B = 0
for(i in 1 : 200)
{
  e = rnorm(n + 1, 0, sqrt(delta)) 
  B = 0
  for(k in 1 : n)
    B[k + 1] = B[k] + e[k] 
  lines(seq(0, delta*1000, delta), B, type = 'l', col = "purple")
}

# 4. –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∞–Ω—Å–∞–º–±–ª—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ –ø–æ
#–ø—Ä–∞–≤–∏–ª—É —Ç—Ä–µ—Ö —Å–∏–≥–º.

k_delta = (0 : 1000)*delta
pr1 = 3*sqrt(k_delta)  # –≤–µ—Ä—Ö–Ω–µ–µ –∏ –Ω–∏–∂–Ω–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
pr2 = -3*sqrt(k_delta)
lines(seq(0, delta*1000, delta), pr1, type = 'l') # –ø—Ä–∞–≤–∏–ª–æ —Ç—Ä—ë—Ö —Å–∏–≥–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—á—Ç–∏ –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π
lines(seq(0, delta*1000, delta), pr2, type = 'l')

# 5. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å (9) –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –≤—Ö–æ–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
#ùëÜ0 = 1, ùëé = 0.5, ùúé = 0.9, ‚àö‚àÜ = 0.01, ùëò = 0, 1, . . . , 10^3.

S = S_0 = 1
a = 0.5
sigma = 0.9
delta = 0.0001
k = 0 : 1000
B = 0
e = rnorm(n + 1, 0, sqrt(delta)) 
for(k in 1 : n) 
  B[k + 1] = B[k] + e[k + 1] 
for(k in 1 : (n + 1)) 
  S[k] = S_0*exp((a - sigma^2/2)*k*delta + sigma*B[k])
plot(seq(0, delta*1000, delta), S, type = 'l', main = "–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ (9):")

# 6. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å 200 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞ (10) –Ω–∞ –æ–¥–Ω–æ–º –≥—Ä–∞—Ñ–∏–∫–µ.

plot(seq(0, delta*1000, delta), B, type = 'l', ylim = c(-1, 1), col = "green", main = "200 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞ (10):")
for(i in 1 : 200)
{
  e = rnorm(n + 1, 0, sqrt(delta)) 
  B = 0
  for(k in 1 : n)
  {
    B[k + 1] = B[k] + e[k]  
    S[k + 1] = S_0*exp((a - sigma^2/2)*(k + 1)*delta + sigma*B[k + 1])
  }
  lines(seq(0, delta*1000, delta), B, type = 'l', col = "green")
}
